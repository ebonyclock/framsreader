[
  {
    "name": "Image Exporter",
    "_classname": "show",
    "info": "Generate creature pictures using the ImageExport class",
    "expdef": "standard",
    "code": "\nglobal g_genotype_index;\nglobal g_exportframe; //=1 only when the frame is to be (or has just been) exported\nglobal g_slowdown; //slowdown if you need more time to manually adjust camera while simulation is running\n\nfunction onLoad()\n{\n\tSimulator.import(\"vertpos.sim\"); //adjust as needed\n\tSimulator.import(\"all-f0.gen\"); //adjust as needed\n\tSimulator.creatwarnfail = 0; //revive all creatures, even those with warnings\n\tCreatureSettings.bnoise_vel = 0; //was >0 in evolution, but now we don't want to add random velocities\n\tPopulations[0].stabledist = 0.1; //zwiekszamy bo niektore sie wywracaja - musialy polegac na losowych silach i miec szczescie w ewolucji\n\t\n\tGLDisplay.simsteps = 1;\n\n\tTrackingCam.cam_tracking = 1; //tracking = position\n\tTrackingCam.cam_change = 1; //target change = cut\n\tTrackingCam.cam_zoom = 1.1;\n\tTrackingCam.cam_dir = 30;\n\tTrackingCam.cam_h = 45;\n\tImageExport.imgex_outdir = \"img-exported\";\n\tImageExport.imgex_outfiles = \"image%03d.ppm\"; //set later anyway\n\tImageExport.imgex_format = 0; //0=ppm (lossless), 1=jpg (lossy)\n\tImageExport.imgex_skip = 0;\n\n\tExpParams.MaxCreated = 0;\n\tExpParams.placement = 1; //place in the center of the world\n\tg_genotype_index = 0;\n\tg_exportframe = 1;\n\tg_slowdown = 10;\n\tGLDisplay.user_interaction = 0; //hide menu button\n}\n\nfunction setBanner() //adjust to your liking\n{\n\tShowManager.dispinfo = 0;\n\t//GLDisplay.banner=Populations[0][0].name;\n}\n\nfunction onShowStep()\n{\n\tSimulator.sleep(g_slowdown);\n\tvar pop0 = Populations[0];\n\t//Simulator.print(\"\"+pop0.size + \" \" + g_exportframe + \" \" + g_genotype_index);\n\tif (g_exportframe) //frame has just been exported\n\t{\n\t\tg_exportframe = 0;\n\t\t//if (ImageExport.imgex_enabled)\n\t\tImageExport.imgex_disable();\n\t\tif (g_genotype_index >= GenePools[0].size)\n\t\t{\n\t\t\tGLDisplay.quit();\n\t\t\treturn;\n\t\t}\n\t\tif (pop0.size > 0)\n\t\t\tpop0.delete(0);\n\t\tGenePools.genotype = g_genotype_index;\n\t\tg_genotype_index++;\n\t\tPopulations.group = 0;\n\t\tPopulations.createFromGenotype();\n\t\tCreatureSelection.clear();\n\t\tif (pop0.size > 0)\n\t\t\tCreatureSelection.add(pop0[0]);\n\t}\n\tif (pop0[0].perf==1) //stabilized -> time to export! remove this condition if you want to export creatures immediately after revival\n\t{\n\t\t//if (!ImageExport.imgex_enabled)\n\t\tImageExport.imgex_enable();\n\t\tImageExport.imgex_now(); //save current image now = without waiting for the next simulation step\n\t\tImageExport.imgex_outfiles = \"image_\" + String.format(\"%03d\",g_genotype_index-1) + \".ppm\";\n\t\tSimulator.print(\"exporting \"+ImageExport.imgex_outfiles);\n\t\tsetBanner();\n\t\tg_exportframe = 1;\n\t}\n}\n\n"
  }
]